extends ../layout

block content
  div(id="index")
    div(style='margin-top:30px')
      div(class='row')
        div(id="content-left" class='col-md-3 content-index')
          include partials/tree
        div(id="content-mid" class='col-md-6 content-index')
          include partials/file
        div(id="content-right" class='col-md-3 content-index')
          include partials/chat
    
block script
  script(type='text/javascript', src="https://cdn.socket.io/socket.io-1.2.0.js")
  script(type='text/javascript', src="/js/home/chat.js")
  script(type='text/javascript', src="/js/home/files.js")
  script(type='text/javascript', src="/js/home/contatos.js")
  script.
    var socket = io();
    $('.chat').submit(function () {
      var usuario = '#{session.nome}';
      var id = '#{session._id}';
      var email = '#{session.email}';
      var texto = $('#m').val();
      var msg = texto;
      var dados = {msg: msg, id: id, nome: usuario};
      if(texto){
        socket.emit('chat message', dados);
        $('#m').val('');
      }else{
      $('#m').notify('Digite algo', 'info');
      return false;
      }
      return false;
    });
  if messages.info
    script.
        $(document).ready(function(){
            $('.alert').hide();
            var msg = "#{messages.info}";
            $.notify(msg, 'success');
        });
  if messages.erro
    script.
        $(document).ready(function(){
            $('.alert').hide();
            $.notify('#{messages.erro}', 'error');
        });
  script.
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();   
    });